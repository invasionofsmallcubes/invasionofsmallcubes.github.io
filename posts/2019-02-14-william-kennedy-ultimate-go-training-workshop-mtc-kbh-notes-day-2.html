<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="this is my note taking app, shared with everybody"/><meta property="og:image" content="https://og-image.now.sh/Welcome%20to%20the%20Invasion%20Of%20Small%20Cubes.png?theme=dark&amp;md=0&amp;fontSize=75px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><meta name="og:title" content="Welcome to the Invasion Of Small Cubes"/><meta name="twitter:card" content="summary_large_image"/><title>William Kennedy - Ultimate Go Training - Workshop@MTC-KBH - Notes Day 2</title><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/0597f441ba7b4efb46f6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0597f441ba7b4efb46f6.css"/><link rel="preload" href="/_next/static/css/58699b1a35406fdf6fc5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/58699b1a35406fdf6fc5.css"/><link rel="preload" href="/_next/static/chunks/main-7fafde1b574390a64140.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-ccf5ab034a524403276a.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.5e03480598ad1120f007.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.dee2ffe8ab5f8852fbb0.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-035f0da64bba5611db86.js" as="script"/><link rel="preload" href="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.c75a5aa2699ec6de0bb7.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-9ee6474579e6a630e263.js" as="script"/></head><body><div id="__next"><div class="layout_container__2t4v2"><header class="layout_header__2rhWq"><a href="/"><img src="/images/face.jpeg" class="layout_headerImage__2h5On utils_borderCircle__13qdJ" alt="The Invasion of Small Cubes"/></a><h2 class="utils_headingLg__de7p0"><a class="utils_colorInherit__3Gudf" href="/">The Invasion of Small Cubes</a></h2></header><main><article><h1 class="utils_headingXl__1XecN">William Kennedy - Ultimate Go Training - Workshop@MTC-KBH - Notes Day 2</h1><div class="utils_lightText__12Ckm"><time dateTime="2019-02-14">February 14, 2019</time></div><div><p>Don&#x27;t use interfaces in the first place, discover them while refactoring.
Don&#x27;t repeat yourself sometimes it&#x27;s more harmful than anything.</p><p>Write the first thing that it&#x27;s easy, don&#x27;t worry about optimization now.</p><pre style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd;padding:1em;margin:.5em 0;overflow:auto"><code style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd"><span>func (*Xenia) Pull() (*Data, error)</span></code></pre><p>this will put data on the heap</p><pre style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd;padding:1em;margin:.5em 0;overflow:auto"><code style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd"><span>func (*Xenia) Pull(d *Data) error</span></code></pre><p>this will not put data in heap, but will keep in the stack.</p><p>Now I finally understood why marshall and decode have the return element in the argument.</p><p>After we see that the system is stable, when we need to add a new behavior, then we introduce the interface.</p><p>Don&#x27;t define alias as </p><pre style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd;padding:1em;margin:.5em 0;overflow:auto"><code style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd"><span>type Handle int</span></code></pre><p>If you have to explaining it using </p><pre style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd;padding:1em;margin:.5em 0;overflow:auto"><code style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd"><span>int</span></code></pre><p>then it&#x27;s a real use type.</p><pre style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd;padding:1em;margin:.5em 0;overflow:auto"><code style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd"><span>type Duration int64</span></code></pre><p>makes sense because you can explain like <strong>that represents a nanosecond of time</strong></p><p>For the rest check <a href="https://github.com/ardanlabs/gotraining/blob/master/topics/courses/go/design/README.md">here</a></p><p>You need to understand your workload to understand before starting writing for concurrency. You have CPU bound workload and IO bound workload.</p><p>CPU bound workload is when you have an algorithm that doesn&#x27;t move your thread from running to waiting state, only an external event could do that (OS scheduler)</p><p>IO bound workload is a workload that will move from running to waiting, you run operation on OS, open a file for example, use mutexes.</p><p>CPU bound workload is the more efficient work you can do.</p><p>Never use more or less threads than the number of hardware threads you have.</p><p>Every OS has a thread pooling technology. You put the request into the pools and try to do the work with the less number of threads possible.</p><p>What causes a scheduling decision:</p><ul><li>go function</li><li>GC</li><li>syscall (async/sync)
  -- networking in go is really fast</li></ul><p>A runtime will use work stealing algorithms.</p><p>Channels are slow, they&#x27;re filled with latency costs. We need to use them with careful attention. Avoid the use of WaitGroups for performance reasons but you should use them to track the work that has been done.</p><p>To find race conditions, you can run </p><pre style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd;padding:1em;margin:.5em 0;overflow:auto"><code style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd"><span>go build -race</span></code></pre><p>or you can use the also go test </p><pre style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd;padding:1em;margin:.5em 0;overflow:auto"><code style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd"><span>go </span><span class="token builtin class-name">test</span><span> -race -cpu </span><span class="token" style="color:#e09142">24</span></code></pre><p>with extra threads.</p><p>For the rest check <a href="https://github.com/ardanlabs/gotraining/blob/master/topics/courses/go/concurrency/README.md">here</a></p> </div></article></main><div class="layout_backToHome__1vZsp"><a href="/">← Back to home</a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"2019-02-14-william-kennedy-ultimate-go-training-workshop-mtc-kbh-notes-day-2","c":"\nDon't use interfaces in the first place, discover them while refactoring.\nDon't repeat yourself sometimes it's more harmful than anything.\n\nWrite the first thing that it's easy, don't worry about optimization now.\n\n```golang\nfunc (*Xenia) Pull() (*Data, error)\n```\nthis will put data on the heap\n\n```golang\nfunc (*Xenia) Pull(d *Data) error\n``` \nthis will not put data in heap, but will keep in the stack.\n\nNow I finally understood why marshall and decode have the return element in the argument.\n\nAfter we see that the system is stable, when we need to add a new behavior, then we introduce the interface.\n\nDon't define alias as \n```golang\ntype Handle int\n``` \nIf you have to explaining it using \n```golang\nint\n``` \nthen it's a real use type.\n```golang\ntype Duration int64\n``` \nmakes sense because you can explain like **that represents a nanosecond of time**\n\nFor the rest check [here](https://github.com/ardanlabs/gotraining/blob/master/topics/courses/go/design/README.md)\n\nYou need to understand your workload to understand before starting writing for concurrency. You have CPU bound workload and IO bound workload.\n\nCPU bound workload is when you have an algorithm that doesn't move your thread from running to waiting state, only an external event could do that (OS scheduler)\n\nIO bound workload is a workload that will move from running to waiting, you run operation on OS, open a file for example, use mutexes.\n\nCPU bound workload is the more efficient work you can do.\n\nNever use more or less threads than the number of hardware threads you have.\n\nEvery OS has a thread pooling technology. You put the request into the pools and try to do the work with the less number of threads possible.\n\nWhat causes a scheduling decision:\n\n- go function\n- GC\n- syscall (async/sync)\n    -- networking in go is really fast\n\nA runtime will use work stealing algorithms.\n\nChannels are slow, they're filled with latency costs. We need to use them with careful attention. Avoid the use of WaitGroups for performance reasons but you should use them to track the work that has been done.\n\nTo find race conditions, you can run \n```bash\ngo build -race\n``` \nor you can use the also go test \n```bash\ngo test -race -cpu 24\n```\nwith extra threads.\n\nFor the rest check [here](https://github.com/ardanlabs/gotraining/blob/master/topics/courses/go/concurrency/README.md)","title":"William Kennedy - Ultimate Go Training - Workshop@MTC-KBH - Notes Day 2","date":"2019-02-14"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"2019-02-14-william-kennedy-ultimate-go-training-workshop-mtc-kbh-notes-day-2"},"buildId":"GRbvKsYHkQMHs-3O6ylhf","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-9297741ddbbb81bca141.js"></script><script src="/_next/static/chunks/main-7fafde1b574390a64140.js" async=""></script><script src="/_next/static/chunks/webpack-ccf5ab034a524403276a.js" async=""></script><script src="/_next/static/chunks/framework.5e03480598ad1120f007.js" async=""></script><script src="/_next/static/chunks/commons.dee2ffe8ab5f8852fbb0.js" async=""></script><script src="/_next/static/chunks/pages/_app-035f0da64bba5611db86.js" async=""></script><script src="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.c75a5aa2699ec6de0bb7.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-9ee6474579e6a630e263.js" async=""></script><script src="/_next/static/GRbvKsYHkQMHs-3O6ylhf/_buildManifest.js" async=""></script><script src="/_next/static/GRbvKsYHkQMHs-3O6ylhf/_ssgManifest.js" async=""></script></body></html>