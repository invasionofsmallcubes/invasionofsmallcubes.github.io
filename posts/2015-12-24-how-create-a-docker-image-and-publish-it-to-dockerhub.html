<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="this is my note taking app, shared with everybody"/><meta property="og:image" content="https://og-image.now.sh/Welcome%20to%20the%20Invasion%20Of%20Small%20Cubes.png?theme=dark&amp;md=0&amp;fontSize=75px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><meta name="og:title" content="Welcome to the Invasion Of Small Cubes"/><meta name="twitter:card" content="summary_large_image"/><title>How to create an octopress docker image and publish it on DockerHub</title><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/329c9c2bc5a274fcd45b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/329c9c2bc5a274fcd45b.css"/><link rel="preload" href="/_next/static/css/58699b1a35406fdf6fc5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/58699b1a35406fdf6fc5.css"/><link rel="preload" href="/_next/static/chunks/main-7fafde1b574390a64140.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-ccf5ab034a524403276a.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.5e03480598ad1120f007.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.dee2ffe8ab5f8852fbb0.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-af9523d707310327217f.js" as="script"/><link rel="preload" href="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.c75a5aa2699ec6de0bb7.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-9ee6474579e6a630e263.js" as="script"/></head><body><div id="__next"><div class="layout_container__2t4v2"><header class="layout_header__2rhWq"><a href="/"><img src="/images/face.jpeg" class="layout_headerImage__2h5On utils_borderCircle__13qdJ" alt="The Invasion of Small Cubes"/></a><h2 class="utils_headingLg__de7p0"><a class="utils_colorInherit__3Gudf" href="/">The Invasion of Small Cubes</a></h2></header><main><article><h1 class="utils_headingXl__1XecN">How to create an octopress docker image and publish it on DockerHub</h1><div class="utils_lightText__12Ckm"><time dateTime="2015-12-24">December 24, 2015</time></div><div><p>This are my notes about how to configure a docker image and publish it on DockerHub.
It&#x27;s just a condensed guide but you won&#x27;t find anything new.</p><p>As you know <a href="https://github.com/octopress/octopress" title="Octopress Github Repository">octopress</a> is a ruby project with some peculiar dependency.
I&#x27;m not a ruby developer so I would like not to have that many things on my pc used only for that purpose.</p><p>Now, my intention is to use this image as a virtual machine where I can run octopress commands. And that&#x27;s not
how you usually use a docker image. It&#x27;s actually really different from the day to day usage but I&#x27;m not going
to argue about the fact that I&#x27;m not using it in the proper way: you&#x27;re right and Han shot first. That is not going
to change the fact that we had Episodes 1 2 and 3 and the same goes for how I use docker in this case.</p><p>(if you&#x27;re wondering about the fact that all this ranting was to make a Star Wars reference: right again :P )</p><p>When you create a new image you&#x27;ll describe the way it&#x27;s configured in a Dockerfile. Let&#x27;s see mine:</p><pre style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd;padding:1em;margin:.5em 0;overflow:auto"><code style="font-family:Consolas, Menlo, Monaco, &quot;Andale Mono WT&quot;, &quot;Andale Mono&quot;, &quot;Lucida Console&quot;, &quot;Lucida Sans Typewriter&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Liberation Mono&quot;, &quot;Nimbus Mono L&quot;, &quot;Courier New&quot;, Courier, monospace;font-size:14px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;background:#2a2734;color:#9a86fd"><span>FROM debian:jessie
</span>MAINTAINER Emanuele Ianni &lt;dierre@gmail.com&gt;
<!-- -->
<!-- -->ENV BUILD_PACKAGES bash libcurl4-openssl-dev git
<!-- -->ENV RUBY_PACKAGES ruby ruby-dev bundler
<!-- -->ENV EXECJS_DEPENDENCY nodejs
<!-- -->ENV GIT_URL https://github.com/octopress/octopress.git
<!-- -->
<!-- --># Update and install all of the required packages.
<!-- --># At the end, remove the apk cache
<!-- -->RUN apt-get update -y
<!-- -->RUN apt-get upgrade -y
<!-- -->RUN apt-get install -y $BUILD_PACKAGES
<!-- -->RUN apt-get install -y $RUBY_PACKAGES
<!-- -->RUN apt-get install -y $EXECJS_DEPENDENCY
<!-- -->RUN rm -rf /var/cache/apk/*
<!-- -->
<!-- --># cloning octopress repo and installing version
<!-- -->
<!-- -->RUN gem install --no-rdoc --no-ri pry-byebug
<!-- -->RUN gem install --no-rdoc --no-ri octopress-ink
<!-- -->RUN gem install --no-rdoc --no-ri clash
<!-- -->RUN gem install --no-rdoc --no-ri octopress
<!-- -->RUN mkdir octopress
<!-- -->WORKDIR octopress
</code></pre><p>You can check official documentation to know how to use <a href="https://docs.docker.com/engine/reference/commandline/build/">docker build</a> and what keys you can user in a <a href="https://docs.docker.com/engine/reference/builder/">Dockerfile</a>.</p><p>What I would like to stress about it here is just keep it readable because configuring a docker image could be really complex. You can use <code>ENV</code> to set up environment variables that you can use later with <code>$VARIABLE</code>.
Remember the difference between <code>RUN</code> and <code>CMD</code>. <code>RUN</code> is used with <code>docker build</code> whereas <code>CMD</code> is used when you use <code>docker run</code>.</p><p>In this particular case to build the image (that you can find on <a href="https://hub.docker.com/r/invasionofsmallcubes/octopress/">DockerHub</a> ) just run <code>docker build -t octopress .</code>.</p><p>To run it is a little bit trickier than usual but it&#x27;s doable: <code>docker run -p 4000:4000 -v /Users/dierre/Projects/octopress/:/octopress -i -t --entrypoint=&quot;/bin/bash&quot; invasionofsmallcubes/octropress</code>.</p><p>Here you <em>expose</em> the port 4000 that you will later use to check a preview of your blog, you&#x27;ll start your docker image opening a console and then you share the content of your octopress repository that in my case is in <em>/Users/dierre/Projects/octopress/</em>.</p><p>To <a href="https://docs.docker.com/mac/step_six/">tag</a> a built image you can just follow the official documentation, it&#x27;s pretty straightforward.</p><p>Last note: if you are using OSX then docker will start in a VirtualBox machine named <em>default</em> which has a specific address. You you want to see a preview of the blog, remember to run <code>jekyll serve --host 0.0.0.0</code>, where the option <code>--host 0.0.0.0</code> is used to open jekyll to answer to every call from everywhere, because the default behaviour is just listen to 127.0.0.1 which is not a viable solution when using docker since you are using the host browser.</p><p>I hope it&#x27;s helpful.</p> </div></article></main><div class="layout_backToHome__1vZsp"><a href="/">‚Üê Back to home</a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"2015-12-24-how-create-a-docker-image-and-publish-it-to-dockerhub","c":"This are my notes about how to configure a docker image and publish it on DockerHub.\nIt's just a condensed guide but you won't find anything new.\n\nAs you know [octopress][faef418d] is a ruby project with some peculiar dependency.\nI'm not a ruby developer so I would like not to have that many things on my pc used only for that purpose.\n\nNow, my intention is to use this image as a virtual machine where I can run octopress commands. And that's not\nhow you usually use a docker image. It's actually really different from the day to day usage but I'm not going\nto argue about the fact that I'm not using it in the proper way: you're right and Han shot first. That is not going\nto change the fact that we had Episodes 1 2 and 3 and the same goes for how I use docker in this case.\n\n(if you're wondering about the fact that all this ranting was to make a Star Wars reference: right again :P )\n\nWhen you create a new image you'll describe the way it's configured in a Dockerfile. Let's see mine:\n\n~~~~~~~~\nFROM debian:jessie\nMAINTAINER Emanuele Ianni \u003cdierre@gmail.com\u003e\n\nENV BUILD_PACKAGES bash libcurl4-openssl-dev git\nENV RUBY_PACKAGES ruby ruby-dev bundler\nENV EXECJS_DEPENDENCY nodejs\nENV GIT_URL https://github.com/octopress/octopress.git\n\n# Update and install all of the required packages.\n# At the end, remove the apk cache\nRUN apt-get update -y\nRUN apt-get upgrade -y\nRUN apt-get install -y $BUILD_PACKAGES\nRUN apt-get install -y $RUBY_PACKAGES\nRUN apt-get install -y $EXECJS_DEPENDENCY\nRUN rm -rf /var/cache/apk/*\n\n# cloning octopress repo and installing version\n\nRUN gem install --no-rdoc --no-ri pry-byebug\nRUN gem install --no-rdoc --no-ri octopress-ink\nRUN gem install --no-rdoc --no-ri clash\nRUN gem install --no-rdoc --no-ri octopress\nRUN mkdir octopress\nWORKDIR octopress\n~~~~~~~~\n\nYou can check official documentation to know how to use [docker build](https://docs.docker.com/engine/reference/commandline/build/) and what keys you can user in a [Dockerfile](https://docs.docker.com/engine/reference/builder/).\n\nWhat I would like to stress about it here is just keep it readable because configuring a docker image could be really complex. You can use `ENV` to set up environment variables that you can use later with `$VARIABLE`.\nRemember the difference between `RUN` and `CMD`. `RUN` is used with `docker build` whereas `CMD` is used when you use `docker run`.\n\nIn this particular case to build the image (that you can find on [DockerHub](https://hub.docker.com/r/invasionofsmallcubes/octopress/) ) just run `docker build -t octopress .`.\n\nTo run it is a little bit trickier than usual but it's doable: `docker run -p 4000:4000 -v /Users/dierre/Projects/octopress/:/octopress -i -t --entrypoint=\"/bin/bash\" invasionofsmallcubes/octropress`.\n\nHere you _expose_ the port 4000 that you will later use to check a preview of your blog, you'll start your docker image opening a console and then you share the content of your octopress repository that in my case is in _/Users/dierre/Projects/octopress/_.\n\nTo [tag](https://docs.docker.com/mac/step_six/) a built image you can just follow the official documentation, it's pretty straightforward.\n\nLast note: if you are using OSX then docker will start in a VirtualBox machine named _default_ which has a specific address. You you want to see a preview of the blog, remember to run `jekyll serve --host 0.0.0.0`, where the option `--host 0.0.0.0` is used to open jekyll to answer to every call from everywhere, because the default behaviour is just listen to 127.0.0.1 which is not a viable solution when using docker since you are using the host browser.\n\nI hope it's helpful.\n\n  [faef418d]: https://github.com/octopress/octopress \"Octopress Github Repository\"\n","title":"How to create an octopress docker image and publish it on DockerHub","date":"2015-12-24"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"2015-12-24-how-create-a-docker-image-and-publish-it-to-dockerhub"},"buildId":"_d9NckLkmpyl-6jygcJrT","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-9297741ddbbb81bca141.js"></script><script src="/_next/static/chunks/main-7fafde1b574390a64140.js" async=""></script><script src="/_next/static/chunks/webpack-ccf5ab034a524403276a.js" async=""></script><script src="/_next/static/chunks/framework.5e03480598ad1120f007.js" async=""></script><script src="/_next/static/chunks/commons.dee2ffe8ab5f8852fbb0.js" async=""></script><script src="/_next/static/chunks/pages/_app-af9523d707310327217f.js" async=""></script><script src="/_next/static/chunks/7989c093b81d86ddb0abfb342d5bc2e84730435d.c75a5aa2699ec6de0bb7.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-9ee6474579e6a630e263.js" async=""></script><script src="/_next/static/_d9NckLkmpyl-6jygcJrT/_buildManifest.js" async=""></script><script src="/_next/static/_d9NckLkmpyl-6jygcJrT/_ssgManifest.js" async=""></script></body></html>