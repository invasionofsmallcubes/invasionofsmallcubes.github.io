{"pageProps":{"postData":{"id":"2013-09-25-enable-test-coverage-for-sonarqube-with-karma-dot-js","c":"Recently I had to integrate the test coverage of our javascript projects into SonarQube. I'm using Karma.js 0.8.5 so the config file has the old syntax layout but it applies also to the new type of configuration.\n\nThis is a quick post with the necessary configuration.\n\nFirst declare a *coverageReporter* of type **lcov**.\n\n~~~ javascript\ncoverageReporter = {\n\ttype : 'lcov',\n\tdir : 'build/reports/coverage/'\n}\n~~~\n\nThen declare **coverage** as one of the *reporters*\n\n~~~ javascript\nreporters = ['progress', 'dots', 'junit', 'coverage'];\n~~~\n\nAnd your done with the *karma.js* part.\n\nNow, the following part is for **gradle** but I'm pretty sure you'll need the same options with **maven**.\n\nTo start karma I created a gradle task:\n\n~~~ java\ntask karmaTest(type:Exec) {\n\n  commandLine \"karma\", \"--singleRun\", \"true\", \"--browsers\", \"PhantomJS\", \"start\", \"src/test/js/config/karma.conf.js\"\n\n  standardOutput = new ByteArrayOutputStream()\n\n  ext.output = {\n    return standardOutput.toString();\n  }\n}\n~~~\n\nAnd then\n\n~~~ java\nproject(\":your-project\") {\n  apply plugin: 'sonar-runner'\n  sonarRunner {\n    sonarProperties {\n      property \"sonar.projectName\", \"Your project\"\n      property \"sonar.projectKey\", \"com.example:yourproject\"\n      property \"sonar.host.url\", \"http://localhost:9000\"\n      property \"sonar.jdbc.url\", \"jdbc:mysql://localhost:3306/sonar?useUnicode=true&characterEncoding=utf8\"\n      property \"sonar.jdbc.driverClassName\", \"com.mysql.jdbc.Driver\"\n      property \"sonar.jdbc.username\", \"root\"\n      property \"sonar.jdbc.password\", \"root\"\n      property \"sonar.projectVersion\", \"1.0.SNAPSHOT\"\n      property \"sonar.dynamicAnalysis\", \"reuseReports\"\n      property \"sonar.modules\", \"java-module,javascript-module\"\n      property \"java-module.sonar.projectName\",\"Java Module\"\n      property \"java-module.sonar.projectBaseDir\", \"${project.projectDir}\"\n      property \"java-module.sonar.jacoco.reportPath\", \"build/jacoco/test.exec\"\n\n      // JAVASCRIPT MODULE BEGINS\n      property \"javascript-module.sonar.projectName\",\"JavaScript Module\"\n      property \"javascript-module.sonar.language\",\"js\"\n      property \"javascript-module.sonar.sources\",\"src/main/webapp/js/app\"\n      property \"javascript-module.sonar.tests\",\"src/test/js/spec/\"\n      property \"javascript-module.sonar.projectBaseDir\", \"$project.projectDir\"\n      property \"javascript-module.sonar.javascript.jstest.reportsPath\", \"build/reports/tests/\"\n      property \"javascript-module.sonar.javascript.lcov.reportPath\", \"build/reports/coverage/PhantomJS 1.9 (Linux)/lcov.info\"\n    }\n  }\n}\n~~~\n\nThe annoying thing I can't still resolve is that *lcov.info* is under the directory *PhantomJS 1.9 (Linux)* cannot be renamed, or at least I can't find how.\n","title":"Enable test coverage for SonarQube with Karma.js","date":"2013-09-25"}},"__N_SSG":true}